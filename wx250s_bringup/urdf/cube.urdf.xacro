<?xml version="1.0"?>
<!-- filepath: /home/sughetto/interbotix_ws/src/wx250s_bringup/urdf/test_cube.urdf.xacro -->
<robot xmlns:xacro="http://ros.org/wiki/xacro" name="cube">
  <!-- A simple cube that's easier to grasp than a sphere -->
  <xacro:property name="side" value="0.03" />  <!-- 3cm cube -->
  <xacro:property name="mass" value="0.010" />
  
  <!-- Define robot_name property -->
  <xacro:arg name='robot_name' default='cube'/>
  <xacro:property name="robot_name" value="$(arg robot_name)"/>
  
  <!-- World link-->
  <link name="world"/>

  <!-- Cube link -->
  <link name="cube_link">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="${side} ${side} ${side}"/>
      </geometry>
      <material name="red">
        <color rgba="1 0 0 1"/>
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="${side} ${side} ${side}"/>
      </geometry>
    </collision>

    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="${mass}"/>
      <!-- Inertia for a cube-->
      <inertia 
        ixx="${mass * side * side / 6.0}" ixy="0.0" ixz="0.0"
        iyy="${mass * side * side / 6.0}" iyz="0.0" 
        izz="${mass * side * side / 6.0}"/>
    </inertial>
  </link>

  <!-- Virtual floating joint to track cube position -->
  <joint name="cube_world_joint" type="floating">
    <parent link="world"/>
    <child link="cube_link"/>
  </joint>

  <gazebo reference="cube_link">
    <material>Gazebo/Red</material>
    <auto_disable>false</auto_disable>
  </gazebo>

  <!-- Position publisher plugin for cube -->
  <gazebo>
    <plugin name="p3d_base_controller" filename="libgazebo_ros_p3d.so">
      <ros>
        <!-- Use the robot name as namespace (will be the model name in Gazebo) -->
        <namespace>/${robot_name}</namespace>
        <remapping>odom:=pose</remapping>
      </ros>
      <body_name>cube_link</body_name>
      <frame_name>world</frame_name>
      <update_rate>30.0</update_rate>
      <xyz_offset>0 0 0</xyz_offset>
      <rpy_offset>0 0 0</rpy_offset>
      <gaussian_noise>0.01</gaussian_noise>
    </plugin>
  </gazebo>

  <!-- Joint state publisher plugin -->
  <gazebo>
    <plugin name="joint_state_publisher" filename="libgazebo_ros_joint_state_publisher.so">
      <ros>
        <namespace>/${robot_name}</namespace>
      </ros>
      <joint_name>cube_world_joint</joint_name>
      <update_rate>30.0</update_rate>
    </plugin>
  </gazebo>
</robot>
